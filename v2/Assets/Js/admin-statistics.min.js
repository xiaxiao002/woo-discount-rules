var response_content,isjQueryReady=!1,isGoogleChartsReady=!1,isInitialized=!1;function googleChartsLoadCallback(){isGoogleChartsReady=!0,init()}function init(){isjQueryReady&&isGoogleChartsReady&&!isInitialized&&(isInitialized=!0,jQuery(".chart-period").change(function(){var b=jQuery(".chart-period").val(),a=new Date;if("this_week"===b)a.setDate(a.getDate()-a.getDay()+1),jQuery(".chart-period-start").val(format_date(a)),a.setDate(a.getDate()+6),jQuery(".chart-period-end").val(format_date(a));else if("this_month"===b){var c=new Date(a.getFullYear(),a.getMonth(),1);jQuery(".chart-period-start").val(format_date(c));var d=new Date(a.getFullYear(),a.getMonth()+1,-1);jQuery(".chart-period-end").val(format_date(d))}}),jQuery(".chart-period-start, .chart-period-end").change(function(){jQuery(".chart-period").val("custom")}),jQuery(".chart-options").submit(function(a){return a.preventDefault(),showChart(jQuery(this).serialize()),!1}),jQuery(window).resize(function(){response_content.data.columns.length>1&&renderChart(response_content.data)}),jQuery(".chart-period").change(),jQuery(".chart-options").submit())}function renderChart(a){var b=new google.visualization.DataTable;a.columns&&a.columns.forEach(function(a,c){b.addColumn(0===c?"string":"number",a)}),a.rows&&(b.addRows(Object.values(a.rows)),new google.visualization.NumberFormat({fractionDigits:2}).format(b,1));var d=jQuery("#chart-container").width(),c=jQuery(window).height()-jQuery("#chart-container").offset().top;200>c&&(c=200);var e={chart:{title:a.title?a.title:"",subtitle:a.subtitle?a.subtitle:""},width:d,height:c},f=new google.charts.Line(document.getElementById("chart-container"));f.draw(b,e)}function showChart(a){let b=jQuery(".woo_discount_loader");b.show(),jQuery.post(ajaxurl,{action:"wdr_admin_statistics",method:"get_chart_data",params:a},function(a){b.hide(),a.success&&a.data.columns.length>1?(response_content=a,renderChart(a.data)):jQuery("#chart-container").html(wdr_data.localization_data.chart_data)},"json")}function to2Digits(a){return a<10?"0"+a:a}function format_date(a){return[to2Digits(a.getFullYear()),to2Digits(a.getMonth()+1),to2Digits(a.getDate())].join("-")}google.charts.load("current",{packages:["line"]}),google.charts.setOnLoadCallback(googleChartsLoadCallback),jQuery(document).ready(function(){isjQueryReady=!0,jQuery(".chart-type").select2(),init()})